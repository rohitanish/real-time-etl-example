name: Notebook Syntax Check

on:
  push:
    branches:
      - main   # Run on pushes to main
  pull_request: # Also run on PRs
  workflow_dispatch: # Allow manual trigger

jobs:
  syntax-check:
    runs-on: ubuntu-latest

    steps:
      # Step 1: Checkout repo
      - name: Checkout repository
        uses: actions/checkout@v3

      # Step 2: Set up Python
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      # Step 3: Install nbconvert (only if notebooks are .ipynb)
      - name: Install dependencies
        run: |
          pip install nbconvert

      # Step 4: Convert notebooks to .py (skip if you already have .py files in repo)
      - name: Convert notebooks to Python
        run: |
          for nb in notebooks/*.ipynb; do
            jupyter nbconvert --to script "$nb"
          done

      # Step 5: Syntax check all Python files
      - name: Syntax check notebooks
        run: |
          for file in notebooks/*.py; do
            echo "Checking $file"
            python -m py_compile "$file"
          done